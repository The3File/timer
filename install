PREFIX="${PREFIX:-/usr/local}"
bin_dir="${PREFIX}/bin"
man_dir="${PREFIX}/share/man/man1"

bin="timer"
man="doc/timer.1"

install(){
	copy  "$bin" "$bin_dir"
	copy  "$man" "$man_dir"
}

uninstall(){
	remove "${bin_dir}/${bin##*/}"
	remove "${man_dir}/${man##*/}"
}

copy(){
	[[ "$1" -nt "${2}/${1}" ]] || return
	cp -rf $1 $2 || return
	printf '%s\n' "installed to $2"
}

remove(){
	[[ -a "$1" ]] || return
	rm $1 || return
	printf '%s\n' "uninstalled $1"
}

check_dirs(){
	for dir in "$@"; do
		[[ -d $dir ]] && return 0
		printf '%s\n' "$dir: no such dir"
		exit 1
	done
}

check_dirs "$bin_dir" "$man_dir"

case $1 in
	u*) uninstall ;;
	'') install ;;
esac
